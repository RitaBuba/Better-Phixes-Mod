bpm_je_christian_democrat_ideology_rate = {
	value = 0

	add = { ##### Countries with strong trade unions (Germany, France, Belgium) and high industrialization were progressive and definitely Christian Democratic
		desc = "BPM_VALUE_FROM_TRADE_UNIONS_CLOUT"
		if = {
			limit = {
				exists = ig:ig_trade_unions
			}
			add = ROOT.ig:ig_trade_unions.interest_group_population_percentage # ig_clout
			multiply = 10
		}
	}

	add = { ##### Countries with significant peasantry (not farmers!) were more progressive (Poland, Czechoslovakia, Italy)
		desc = "BPM_VALUE_FROM_PEASANT_POPULATION"
		value = var:bpm_peasant_population_yandev_var
		multiply = 0.05 # 0.04
	}

	##### This was moved down to class-focused values!

	#add = { ##### Countries with modern machinery, technology and automatization also had more progressive Christian Democrats (France, Belgium, Netherlands)
	#	desc = "BPM_VALUE_FROM_MACHINIST_POPULATION"
	#	if = {
	#		limit = { has_variable = bpm_machinist_population_yandev_var }
	#		add = {
	#			value = var:bpm_machinist_population_yandev_var
	#			multiply = 0.15 # 0.2
	#		}
	#	}
	#}

	add = { ##### Countries with strong labour consciousness and movements (Belgium, Italy, Germany)
		desc = "BPM_VALUE_FROM_LABOUR_CONCIOUSNESS"
		if = { 
			limit = {
				has_variable = bpm_consciousness_labor
			}
			add = {
				value = ROOT.var:bpm_consciousness_labor
				multiply = 0.01
			}
		}
		if = { ### As well as socialists were also a bit more progressive, likely due to pragmatism! (France, Italy, Czechoslovakia)
			limit = {
				has_global_variable = first_intl_chain_complete_var
			}
			every_interest_group = {
				limit = {
					OR = {
						bpm_ig_is_socialist = yes
						is_interest_group_type = ig_reformist_socialists
					}
					ig_clout >= 0.01
				}
				add = ig_clout
			}
		}
	}

	add = { ##### Countries where liberalism was omnipresent... (France, Germany, Italy)
		desc = "BPM_VALUE_FROM_LIBERAL_CONCIOUSNESS_SECULARISTS_LIBERAL_NATIONALISTS_MOVEMENT"
		if = { 
			limit = {
				has_variable = bpm_consciousness_liberal
			}
			add = {
				value = ROOT.var:bpm_consciousness_liberal
				multiply = 0.0077
			}
		}

		if = { ### ...served as a backing for pan-national movements... (Germany, Italy)
			limit = {
				OR = {
					country_has_primary_culture = cu:north_german
					country_has_primary_culture = cu:north_italian
				}
				has_technology_researched = pan-nationalism
			}
			every_interest_group = {
				limit = {
					is_interest_group_type = ig_national_liberals
				}
				add = ig_clout
			}
			every_political_movement = {
				limit = {
					bpm_movement_is_liberal_nationalist = yes
				}
				add = political_movement_support
				multiply = 0.5
			}
		}
		
		if = { ### ...and where secularism was present... has Christian Democratic Catholics! (France)
			limit = {
				any_interest_group = {
					OR = {
						has_ideology = ideology:ideology_rel_secularist
						has_ideology = ideology:ideology_rel_radical_secularist
						has_ideology = ideology:ideology_rel_atheist
					}
				}
			}
			every_interest_group = {
				limit = {
					has_ideology = ideology:ideology_rel_secularist # Notably Liberals, Agrarian Populists.
				}
				add = {
					value = ig_clout
					multiply = 0.33
				}
			}
			every_interest_group = {
				limit = {
					has_ideology = ideology:ideology_rel_radical_secularist # Notably Radical Liberals and all Socialists
				}
				add = {
					value = ig_clout
					multiply = 0.66
				}
			}
			every_interest_group = {
				limit = {
					has_ideology = ideology:ideology_rel_atheist # Notably Communists, if the enemy is too atheist then they'll become more Christian.
				}
				subtract = {
					value = ig_clout
					multiply = 0.99
				}
			}
		}
	}

	add = { ##### The less liberal nations had Christian Democrats develop towards universal suffrage and pro-union legislation. (Poland, 
		desc = "BPM_VALUE_FROM_ILLIBERAL_SOCIETY_AND_STATE"
		
		if = { ### Can't be liberal if they moved towards authoritarianism themselves!
			limit = {
				ig:ig_christian_democrats = {
					#NOT = {
					#	AND = {
					#		is_in_government = yes
					#		has_ideology = ideology:ideology_dop_illiberal_democrat
					#	}
					#}
					bpm_ig_is_marginal = no
				}
			}

			###################################################
			####### Suffrage and Voting Rights

			if = { # Autocratic Government drives them to the left very hard (Poland; Lidovci response to AgrPop authoritarianism)
				limit = {
					OR = {
						has_law = law_type:law_autocracy
						has_law = law_type:law_military_junta
						has_law = law_type:law_landed_voting
						has_law = law_type:law_technocracy
					}
				}
				add = {
					value = 0.005
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = { # Wealth-based and education-based voting drives them to the left but less so (Italan Popularists, Belgian New Right)
				limit = {
					OR = {
						has_law = law_type:law_wealth_voting
						has_law = law_type:law_census_voting
					}
				}
				add = {
					value = 0.003
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = { # Universal suffrage makes catholic laymen more inclined to defend them and their own labour-focused interests (Everywhere pretty much)
				limit = {
					has_law = law_type:law_universal_suffrage
				}
				add = {
					value = 0.002
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			if = { # Women should also vote! Though not work.
				limit = {
					NOT = {
						has_law = law_type:law_womens_suffrage
					}
				}
				add = {
					value = 0.00025
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			###################################################
			####### Labour Unions and Labouresque Legislation

			if = { # Reactionary and anti-labor legislation and laws drive them towards more left-wing positions.
				limit = {
					OR = {
						has_law = law_type:law_limited_labor_unions
						has_law = law_type:law_illegal_labor_unions
						has_law = law_type:law_state_controlled_labor_unions
					}
				}
				add = {
					value = 0.003
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}
			else_if = { # Syndicalist-eqsue and free labour are something Christian Democrats strive for and will try to defend the current state of things.
				limit = {
					OR = {
						has_law = law_type:law_all_labor_unions_allowed
						has_law = law_type:law_syndicalism
					}
				}
				add = {
					value = 0.0025
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			###################################################
			####### Censorship and State Power

			if = { # Censorship and worse will make catholics defend themselves fiercly
				limit = {
					OR = {
						has_law = law_type:law_censorship
						has_law = law_type:law_outlawed_dissent
					}
				}
				add = {
					value = 0.002
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			###################################################
			####### Separation of Powers

			if = { # Advisory Body will make them rather unhappy.
				limit = {
					has_law = law_type:law_advisory_body
				}
				add = {
					value = 0.003
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = { # A moderate status quo is rather good for them...
				limit = {
					has_law = law_type:law_separated_powers
				}
				add = {
					value = 0.002
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = { # Too much liberalism is very bad!
				limit = {
					has_law = law_type:law_supreme_legislature
				}
				add = {
					value = 0.005
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_STRONG_LABOR_LIBERAL_RADICAL_MOVEMENTS"

		if = {
			limit = {
				always = yes
			}
			every_political_movement = {
				limit = {
					OR = {
						is_political_movement_type = movement_modernizer
						is_political_movement_type = movement_liberal
					}	
				}
				add = {
					value = political_movement_support
					multiply = ROOT.ig:ig_christian_democrats.ig_clout
					multiply = 25
				}
			}
		}

		if = {
			limit = {
				always = yes
			}
			every_political_movement = {
				limit = {
					is_political_movement_type = movement_labor
				}
				add = {
					value = political_movement_support
					multiply = ROOT.ig:ig_christian_democrats.ig_clout
					multiply = 30
				}
			}
		}

		if = {
			limit = {
				always = yes
			}
			every_political_movement = {
				limit = {
					is_political_movement_type = movement_radical
				}
				add = {
					value = political_movement_support
					multiply = ROOT.ig:ig_christian_democrats.ig_clout
					multiply = 28
				}
			}
		}
	}
	
	add = { ##### More conservative-liberal Middle Class and Relatively present moralist had Christian Democrats grew rather conservative (Early Polish Chadecy, Benelux, Austria)
		desc = "BPM_VALUE_FROM_MORALIST_MIDDLE_CLASS_GROUPS"
		
		if = { ### Professional Interests, Business Interests will move them towards more reactionary groups
			limit = {
				OR = {
					exists = ig:ig_intelligentsia
					exists = ig:ig_industrialists
					exists = ig:ig_landowners
					exists = ig:ig_rural_folk
				}
				#scope:journal_entry = {
				#	"scripted_bar_progress(je_bpm_christian_democrat_ideology_progress_bar)" < 50
				#}
			}
			every_interest_group = {
				limit = {
					OR = {
						is_interest_group_type = ig_industrialists
						is_interest_group_type = ig_intelligentsia
						is_interest_group_type = ig_landowners
						is_interest_group_type = ig_rural_folk
					}
					NOT = {
						has_ideology = ideology:ideology_nonexistent
					}
				}
				subtract = ig_clout
			}
			multiply = 1.33
		}

		if = { ### Moralist Interest Groups should drive them towards more conservative and reactionary stances.
			limit = {
				any_interest_group = {
					OR = {
						has_ideology = ideology:ideology_rel_moralist # Conservatives, National Liberals, Market Liberals
						has_ideology = ideology:ideology_rel_radical_moralist # Reactionaries, the Church
					}
				}
 			}
			if = { # Strong moralists drive the Christian Democrats towards right-wing positions (Austria, Hungary to a degree)
				limit = {
					country_has_state_religion = rel:catholic
				}
				every_interest_group = {
					limit = {
						OR = {
							has_ideology = ideology:ideology_rel_moralist
							has_ideology = ideology:ideology_rel_radical_moralist
						}
						NOT = {
							has_ideology = ideology:ideology_nonexistent
						}
					}
					subtract = ig_clout
					multiply = 1.128
				}
			}
			else_if = { # If the laymen are a minority in the state, then illiberalism serves as a threat to catholic laymen! (Germany, later on Netherlands)
				limit = {
					NOT = {
						country_has_state_religion = rel:catholic
					}
				}
				every_interest_group = {
					limit = {
						OR = {
							has_ideology = ideology:ideology_rel_moralist
							has_ideology = ideology:ideology_rel_radical_moralist
						}
						NOT = {
							has_ideology = ideology:ideology_nonexistent
						}
					}
					add = ig_clout
					multiply = 1.25
				}
			}
		}
	}

	

	add = { ##### The Pope, though not directly, excersises his power and influence on Catholics, ultimately deciding their progression
		desc = "BPM_VALUE_FROM_PAPACY"
		if = {
			limit = {
				c:PAP = {
					ruler = {
						has_ideology = ideology:ideology_theocrat
					}
				}
			}
			add = -0.5
			if = {
				limit = {
					country_has_state_religion = rel:catholic
				}
				subtract = {
					value = ROOT.ig:ig_devout.ig_clout
					multiply = 1.66
					if = {
						limit = {
							ig:ig_devout = {
								leader = {
									has_ideology = ideology:ideology_theocrat
								}
							}
						}
						multiply = 1.33
					}
				}
			}
		}
		else_if = {
			limit = {
				c:PAP = {
					ruler = {
						has_ideology = ideology:ideology_moderate
					}
				}
			}
			add = -0.3
			if = {
				limit = {
					country_has_state_religion = rel:catholic
				}
				subtract = {
					value = ROOT.ig:ig_devout.ig_clout
					multiply = 1.66
					if = {
						limit = {
							ig:ig_devout = {
								leader = {
									has_ideology = ideology:ideology_theocrat
								}
							}
						}
						multiply = 1.33
					}
				}
			}
			else_if = {
				limit = {
					country_has_state_religion = rel:catholic
					ig:ig_devout = {
						leader = {
							OR = {
								has_ideology = ideology:ideology_radical
								has_ideology = ideology:ideology_land_reformer
								# has_ideology = ideology:ideology_liberal_democrat
							}
						}
					}
				}
				add = {
					value = ROOT.ig:ig_devout.ig_clout
					multiply = 1.33
				}
			}
		}
	}

	add = { ##### As Christian Democrats progress, they should retain their goal of retaining moderation wherever they currently are.
		desc = "BPM_VALUE_FROM_CONSERVATIVE_MODERATION_EVENTS_AND_OTHER_REASONS"
		
		add = {
			value = 50
			subtract = ROOT.je:je_bpm_christian_or_democrat.var:ideological_leaning_bar_variable
			multiply = ROOT.ig:ig_christian_democrats.ig_clout
			divide = 2.5
		}

		if = { ### Essentially a negative modifier
			limit = {
				has_variable = christian_democrats_ideology_change
			}
			subtract = {
				value = ROOT.var:christian_democrats_ideology_change
				multiply = 0.05
			}
		}

		subtract = {
			value = 4.44
			multiply = bpm_loyalist_population_fraction
			multiply = 1.33
		}

		#else_if = { ### Lots of loyalists will keep them relatively moderate 
		#	limit = {
		#		OR = {
		#			bpm_country_laws_are_very_undemocratic = yes
		#			bpm_country_laws_are_moderately_undemocratic = yes
		#		}
		#	}
		#	add = {
		#		value = 1
		#
		#		multiply = bpm_loyalist_population_fraction
		#		multiply = bpm_loyalist_population_fraction
		#		multiply = 3.33
		#	}
		#}

		if = { ### A moderate leader of ChD will have them be more moderate
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_ideology = ideology:ideology_moderate
					}
				}
			}
			subtract = -0.2
		}
	}

	add = { ##### After Rerum Novarum many catholics drifted towards Christian Democracy...
		desc = "BPM_VALUE_FROM_RERUM_NOVARUM_DEMOCRATIC_RADICALIZATION" ### but some 'radicalized' themselves towards right-wing illiberal approaches (Austria, Lithuania)

		if = {
			limit = {
				has_global_variable = global_rerum_novarum_issued_var
			}

			subtract = {
				value = 50
				add = ROOT.je:je_bpm_christian_or_democrat.var:ideological_leaning_bar_variable
				multiply = ROOT.ig:ig_christian_democrats.ig_clout
				divide = 2.5
			}
		}

		#if = { ### Christian Democrats, once in power, would ALWAYS 'moderate'/'radicalize' towards Christian Democrat or Illiberal Democrat stances. 
		#	limit = {
		#		ig:ig_christian_democrats = {
		#			is_in_government = yes
		#		}
		#		has_global_variable = global_rerum_novarum_issued_var
		#	}
		#	if = { # (Netherlands, New (Old?) Right in Belgium)
		#		limit = {
		#			scope:journal_entry = {
		#				"scripted_bar_progress(je_bpm_christian_democrat_ideology_progress_bar)" > 50
		#			}
		#		}
		#		every_interest_group = {
		#			limit = {
		#				is_interest_group_type = ig_christian_democrats
		#				NOT = {
		#					has_ideology = ideology:ideology_nonexistent
		#				}
		#			}
		#			add = ig_clout
		#		}
		#		multiply = 2.5
		#	}
		#
		#	else_if = { # (Austria, Switzerland)
		#		limit = {
		#			scope:journal_entry = {
		#				"scripted_bar_progress(je_bpm_christian_democrat_ideology_progress_bar)" < 50
		#			}
		#		}
		#		every_interest_group = {
		#			limit = {
		#				is_interest_group_type = ig_christian_democrats
		#				NOT = {
		#					has_ideology = ideology:ideology_nonexistent
		#				}
		#			}
		#			subtract = ig_clout
		#		}
		#		multiply = 1.5
		#	}
		#}
		
		if = { ### Go, go away Divine Democrats! Industry Part
			limit = {
				has_global_variable = global_rerum_novarum_issued_var
				has_technology_researched = anarchism # Trade Federations
			}
			if = { # Countries with a strong middle class (Shopkeepers, Farmers) (To show orientation towards them)
				limit = {
					has_variable = bpm_shopkeeper_population_yandev_var
				}
				subtract = {
					value = ROOT.var:bpm_shopkeeper_population_yandev_var
					multiply = 0.5
				}
				subtract = {
					value = ROOT.var:bpm_farmer_population_yandev_var
					multiply = 0.33
				}
			}
			if = { # Countries with a strong lower class (Labourers, Machinists) were also a bit more progressive.
				limit = {
					OR = {
						has_variable = bpm_laborer_population_yandev_var
						has_variable = bpm_machinist_population_yandev_var
					}
				}
				add = {
					value = ROOT.var:bpm_laborer_population_yandev_var
					multiply = 0.2 # 0.05 - Counter-balance for the 'reactionary' shopkeepers and farmers!
				}
				add = {
					value = ROOT.var:bpm_machinist_population_yandev_var
					multiply = 0.33 # 0.20 - Counter-balance for the 'reactionary' shopkeepers and farmers!
				}
			}
		}
	}
}

bpm_je_christian_democrat_economy_rate = { # bpm_country_fraction_below_expected_sol
	value = 0

	add = { ##### Low Conciousness of labor made Christian Democrats develop towards more capitalist or reactionary anti-capitalist (Austria, Poland)
		desc = "BPM_VALUE_FROM_LABOR_CONCIOUSNESS_BELOW_75_PERCENT"
		if = { 
			limit = {
				has_variable = bpm_consciousness_labor
				ROOT.var:bpm_consciousness_labor <= 75
			}
			add = {
				value = ROOT.var:bpm_consciousness_labor
				multiply = 0.0077
			}
		}
		else = {
			subtract = 0.2
		}
	}

	add = { ##### Lots of rural-peasant pops and sluggish industrialization had more statist Christian Democrats (France, Netherlands, Italy, Poland)
		desc = "BPM_VALUE_FROM_PEASANTS_LABORERS_AND_POPULARITY_OF_PROLETARIAT"
		
		if = {
			limit = {
				has_variable = bpm_peasant_population_yandev_var
			}
			add = {
				value = ROOT.var:bpm_peasant_population_yandev_var
				multiply = 0.05 # 0.04
			}
			add = {
				value = ROOT.var:bpm_laborer_population_yandev_var
				multiply = 0.1 # 0.05 - Counter-balance for the 'reactionary' shopkeepers and farmers!
			}
			add = {
				value = bpm_proletarian_popularity # 0.05%
				multiply = 3.33
			}
		}
	}

	add = { ##### Strong Laissez-Faire politics are not exactly great.
		desc = "BPM_VALUE_FROM_LAISSEZ_FAIRE_VS_INTERVENTIONISM_LAW_IGS_MOVEMENT"
		
		if = { ### 
			limit = {
				ig:ig_christian_democrats = {
					ig_clout >= 0.009
					leader = {
						NOT = {
							has_ideology = ideology:ideology_market_liberal
						}
					}
				}
			}

			###################################################
			####### Laissez-Faire/Traditionalism vs Interventionism/Reactionary Anti-Capitalist

			if = { # Laissez-faire or traditionalism laws make Christian Democrats like a modern economy.
				limit = {
					OR = {
						has_law = law_type:law_laissez_faire
						has_law = law_type:law_traditionalism
					}
				}
				add = {
					value = 0.0133
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = { # Anti-Capitalism
				limit = {
					OR = {
						has_law = law_type:law_industry_banned
						has_law = law_type:law_cooperative_ownership
						has_law = law_type:law_command_economy
					}
					ig:ig_christian_democrats = {
						OR = {
							has_ideology = ideology:ideology_eco_centralized_economy
							leader = {
								has_ideology = ideology:ideology_reactionary_anti_capitalist
							}
						}
					}
				}
				add = {
					value = 0.0077
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = {
				limit = {
					has_law = law_type:law_interventionism
				}
				add = {
					value = 0.0033
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			if = { # Free Trade vs Protectionism (Free Trade is okay during low SoL, its bad anywhere else)
				limit = {
					has_law = law_type:law_free_trade
					NOT = {
						ig:ig_christian_democrats = {
							has_ideology = ideology:ideology_eco_centralized_economy
						}
					}
				}
				subtract = {
					value = 0.0066
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else_if = { # Protectionism is evil if we are heckin' starving.
				limit = {
					NOT = {
						has_law = law_type:law_free_trade
					}
					any_state = {
						has_famine = yes
						owner ?= ROOT
					}
				}
				add = {
					value = 0.01
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}

			else = {
				add = {
					value = 0.0022
					divide = ROOT.ig:ig_christian_democrats.ig_clout
				}
			}
		}

		if = { ### + Laissez-faire and Moderate Interventionist vs - Interventionists and Proletarians (Belgium, Poland, Germany)
			limit = {
				any_interest_group = {
					OR = {
						has_ideology = ideology:ideology_eco_laissez_faire # Libs, Business, Market Liberals
						has_ideology = ideology:ideology_eco_modernizer # Late Libs, Radicals
						has_ideology = ideology:ideology_eco_conservative_agrarian # Conservatives, Reactionaries, some Devout etc.
						has_ideology = ideology:ideology_eco_modern_agrarian # Agrpops, Village Interests
					}
					OR = {
						has_ideology = ideology:ideology_eco_autarky # Fascists
						has_ideology = ideology:ideology_eco_interventionist # Most National Liberals, Patcons
						has_ideology = ideology:ideology_eco_proletarian_economy # All Socialists.
						has_ideology = ideology:ideology_eco_socialist_mixed_economy # Social Democrats
					}
				}
 			}
			every_interest_group = {
				limit = {
					OR = {
						has_ideology = ideology:ideology_eco_laissez_faire
						has_ideology = ideology:ideology_eco_modernizer
						has_ideology = ideology:ideology_eco_conservative_agrarian
					}
					NOT = {
						has_ideology = ideology:ideology_nonexistent
					}
				}
				add = ig_clout
				multiply = 1.55
			}
			every_interest_group = {
				limit = {
					OR = {
						has_ideology = ideology:ideology_eco_autarky
						has_ideology = ideology:ideology_eco_interventionist
						has_ideology = ideology:ideology_eco_proletarian_economy
						has_ideology = ideology:ideology_eco_socialist_autarky
					}
					NOT = {
						has_ideology = ideology:ideology_nonexistent
					}
				}
				subtract = ig_clout
				multiply = 1.33
			}
		}
	}
	

	add = { ##### No state or paternialist-only welfare? This is definitely not enough (Poland, Belgium, Germany)
		desc = "BPM_VALUE_FROM_PATERNALIST_RELIGIOUS_VS_SECULAR_EXTENSIVE_WELFARE"
		
		if = { ### Paternalist, Religious, Distrubutist welfare dominating in clout (Poland, Germany, Belgium) had em pro-welfare
			limit = {
				any_interest_group = {
					OR = {
						has_ideology = ideology:ideology_wel_distributist_welfare
						has_ideology = ideology:ideology_wel_paternalistic_welfare
						has_ideology = ideology:ideology_wel_religious_welfare
						has_ideology = ideology:ideology_wel_market_welfare
						leader = {
							has_ideology = ideology:ideology_market_liberal
						}
					}
				}
				#scope:journal_entry = {
				#	"scripted_bar_progress(je_bpm_christian_democrats_economy_progress_bar)" <= 75
				#}
			}
			every_interest_group = {
				limit = {
					OR = {
						has_ideology = ideology:ideology_wel_distributist_welfare # Notably weird Conservatives, Reactionaries, other guys.
						has_ideology = ideology:ideology_wel_paternalistic_welfare # Nationa Liberals, Paternal Conservatives, Fascists, theoretically some Liberals
						has_ideology = ideology:ideology_wel_religious_welfare # The Church, Conservatives, some rando's
						has_ideology = ideology:ideology_wel_market_welfare # Classical Liberals, Market Liberals
						leader = {
							has_ideology = ideology:ideology_market_liberal
						}
					}
				}
				add = {
					value = ig_clout
					multiply = 1.33
				}
			}
			
		}

		if = { ### Actual public welfare satisfied Christian Democrats and workers... somewhat...!
			limit = {
				any_interest_group = {
					OR = {
						has_ideology = ideology:ideology_wel_public_welfare
						has_ideology = ideology:ideology_wel_expanded_public_welfare
						leader = {
							has_ideology = ideology:ideology_social_democrat
						}
					}
				}
				#scope:journal_entry = {
				#	"scripted_bar_progress(je_bpm_christian_democrats_economy_progress_bar)" <= 75
				#}
			}
			every_interest_group = {
				limit = {
					OR = {
						has_ideology = ideology:ideology_wel_public_welfare # Radical Liberals, some liberals
						has_ideology = ideology:ideology_wel_expanded_public_welfare # Labor, Socialists
						leader = {
							has_ideology = ideology:ideology_social_democrat
						}
					}
				}
				subtract = {
					value = ig_clout
					multiply = 1.66
				}
			}
		}
	}

	add = { ##### Lack of proper healtcare, welfare and rights. 
		desc = "BPM_VALUE_FROM_MARKET_WELFARE_LAWS_BELOW_LVL_3_AND_LACK_OF_WELFARE"
		
		if = {
			limit = {
				ig:ig_christian_democrats = {
					NOR = {
						has_ideology = ideology:ideology_wel_social_market_welfare
						leader = {
							has_ideology = ideology:ideology_market_liberal
						}
					}
				}
			}
			if = {
				limit = {
					OR = {
						has_law = law_type:law_no_health_system
						AND = {
							has_law = law_type:law_private_health_insurance
							owner = {
								institution_investment_level = { 
									institution = institution_health_system value < 3 
								}
							}
						}
					}
					add = {
						value = 0.005
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
					if = {
						limit = {
							owner = {
								institution_investment_level = { 
									institution = institution_health_system 
									value != 0
								}
							}
						}
						add = {
							value = 3
							subtract = "institution_investment_level(institution_health_system)"
							multiply = ROOT.ig:ig_christian_democrats.ig_clout
							divide = 2.5
						}
					}
				}
			}

			if = {
				limit = {
					OR = {
						has_law = law_type:law_no_schools
						AND = {
							OR = {
								has_law = law_type:law_private_schools
								has_law = law_type:law_public_schools
							}
							owner = {
								institution_investment_level = { 
									institution = institution_schools value < 3 
								}
							}
						}
					}
					add = {
						value = 0.005
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
					if = {
						limit = {
							owner = {
								institution_investment_level = { 
									institution = institution_schools 
									value != 0
								}
							}
						}
						add = {
							value = 3
							subtract = "institution_investment_level(institution_schools)"
							multiply = ROOT.ig:ig_christian_democrats.ig_clout
							divide = 2.5
						}
					}
				}
			}

			if = {
				limit = {
					OR = {
						has_law = law_type:law_no_workers_rights
						owner = {
							institution_investment_level = { 
								institution = institution_workplace_safety value < 3 
							}
						}
					}
					add = {
						value = 0.005
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
					if = {
						limit = {
							owner = {
								institution_investment_level = { 
									institution = institution_workplace_safety 
									value != 0
								}
							}
						}
						add = {
							value = 3
							subtract = "institution_investment_level(institution_workplace_safety)"
							multiply = ROOT.ig:ig_christian_democrats.ig_clout
							divide = 2.5
						}
					}
				}
			}

			if = {
				limit = {
					OR = {
						has_law = law_type:law_poor_laws
						has_law = law_type:law_no_social_security
						owner = {
							institution_investment_level = { 
								institution = institution_social_security value < 3 
							}
						}
					}
					add = {
						value = 0.005
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
					if = {
						limit = {
							OR = {
								has_law = law_type:law_wage_subsidies
								has_law = law_type:law_old_age_pension
							}
							owner = {
								institution_investment_level = { 
									institution = institution_social_security 
									value != 0
								}
							}
						}
						add = {
							value = 3
							subtract = "institution_investment_level(institution_social_security)"
							multiply = ROOT.ig:ig_christian_democrats.ig_clout
							divide = 2.5
						}
					}
				}
			}

			if = {
				limit = {
					OR = {
						has_law = law_type:law_child_labor_allowed
						has_law = law_type:law_restricted_child_labor
						has_law = law_type:law_compulsory_primary_school
					}
					add = {
						value = 0.005
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
				}
			}
		}
	}

	add = { # Countries with a proper, conservative and strong middle-class had Christdems more reactionary anti-capitalist, populist etc. (Poland, Austria)
		desc = "BPM_VALUE_FROM_MIDDLE_CLASS_LANDOWNER_POPULATION"

		if = { # Countries with a strong middle class (Shopkeepers, Farmers) (To show orientation towards them)
			limit = {
				OR = {
					has_variable = bpm_shopkeeper_population_yandev_var
					has_variable = bpm_farmer_population_yandev_var
					has_variable = bpm_clergymen_population_yandev_var
					has_variable = bpm_aristocrat_population_yandev_var
				}
			}
			subtract = {
				value = ROOT.var:bpm_shopkeeper_population_yandev_var
				multiply = 0.66
			}
			subtract = {
				value = ROOT.var:bpm_farmer_population_yandev_var
				multiply = 0.66
			}
			subtract = {
				value = ROOT.var:bpm_clergymen_population_yandev_var
				multiply = 0.66
			}
			subtract = {
				value = ROOT.var:bpm_aristocrat_population_yandev_var
				multiply = 1.66
			}
		}
	}

	add = { ##### Wealthy capitalists and dispartity between poor people had christian democrats move towards more state-/anti-capitalist positions (France, Germany, Poland)
		desc = "BPM_VALUE_RERUM_NOVARUM_ECONOMY"

		if = {
			limit = {
				NOT = {
					has_global_variable = global_rerum_novarum_issued_var
					AND = {
						has_technology_researched = corporatism
						has_technology_researched = mechanized_workshops
						has_technology_researched = mutual_funds
					}
				}
			}

			subtract = {
				value = 50
				add = ROOT.je:je_bpm_christian_or_democrat.var:economical_leaning_bar_variable
				multiply = ROOT.ig:ig_christian_democrats.ig_clout
				divide = 3.33
				#max = 0
			}

			every_interest_group = {
				limit = {
					OR = {
						has_ideology = ideology:ideology_eco_traditional_agrarian
						has_ideology = ideology:ideology_eco_conservative_agrarian
						has_ideology = ideology:ideology_eco_autarky
						has_ideology = ideology:ideology_eco_agrarian_autarky
						AND = {
							has_ideology = ideology:ideology_eco_modern_agrarian
							OR = {
								is_interest_group_type = ig_liberals
								is_interest_group_type = ig_national_liberals
								is_interest_group_type = ig_radicals
								is_interest_group_type = ig_conservatives
							}
						}
					}
					NOT = {
						has_ideology = ideology:ideology_nonexistent
					}
				}
				subtract = {
					value = ig_clout
					multiply = 1.44
				}
			}

			if = {
				limit = {
					NOR = {
						has_law = law_type:law_industry_banned
						has_law = law_type:law_traditionalism
						has_law = law_type:law_agrarianism
						has_law = law_type:law_cooperative_ownership
					}
				}

				subtract = {
					value = 1.66
					multiply = ROOT.ig:ig_christian_democrats.ig_clout
					multiply = 2.5
				}
			}
		}

		else_if = {
			limit = {
				has_global_variable = global_rerum_novarum_issued_var
			}

			add = {
				value = 50
				subtract = "scripted_bar_progress(je_bpm_christian_democrat_ideology_progress_bar)"
				multiply = ROOT.ig:ig_christian_democrats.ig_clout
				divide = 2.5
			}

			add = {
				value = bpm_country_fraction_below_expected_sol
				multiply = 1.33
				divide = 55
			}

			if = {
				limit = {
					average_sol <= 15.0
				}
				add = {
					value = 15
					subtract = average_sol
					divide = 100
					multiply = 1.33
					min = 0.0
					#max = 1.0 # (1-0.66)*3 will be 1.02, so we clamp it for nice numbers
				}
			}

			else_if = {
				limit = {
					average_sol >= 15.0
				}
				subtract = {
					value = average_sol
					divide = 100
					subtract = 15
					multiply = 2.5
					min = 0.0
				}
			}

			#add = { # Around 3.66 times the average SoL for the wealthy.
			#	value = average_sol
			#	multiply = 3.66
			#
			#	divide = 125
			#}

			if = { ### Unjust taxation is evil, and we suffer so much! Or do we?
				limit = {
					ig:ig_christian_democrats = {
						ig_clout >= 0.009
					}
				}

				###################################################
				####### Taxation

				if = { # Peasant Tax or lack of one means that wealth cannot be redistributed well!
					limit = {
						OR = {
							has_law = law_type:law_land_based_taxation
							has_law = law_type:law_consumption_based_taxation
						}
					}
					add = {
						value = 0.015
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
				}

				else_if = { # Wealth is still barely redistributed
					limit = {
						has_law = law_type:law_per_capita_based_taxation
					}
					add = {
						value = 0.01
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
				}

				else_if = { # Everyone pays roughly equal, but is it enough?
					limit = {
						has_law = law_type:law_proportional_taxation
					}
					add = {
						value = 0.066
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
				}

				else_if = { # Wealth now is equally and justily redistributed.
					limit = {
						has_law = law_type:law_graduated_taxation
					}
					add = {
						value = 0.0033
						divide = ROOT.ig:ig_christian_democrats.ig_clout
					}
				}
			}
		}	
	}
}

je_bpm_split_christdem_progress_bar_rate = {
	value = 0

	add = {
		desc = "BPM_BASE_VALUE"
		add = 0.1
	}

	add = {
		desc = "BPM_VALUE_FROM_BEING_RELIGIOUS_MINORITY"
		
		if = {
			limit = {
				NOT = {
					country_has_state_religion = rel:catholic
				}
			}
			add = -0.2
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_STRONG_LIBERAL_MOVEMENT"

		if = {
			limit = { 
				OR = { 
					ig:ig_christian_democrats.var:bpm_movement_liberal_pressure > 0.1
					OR = {
						var:bpm_liberal_movement.political_movement_support >= 0.1
						var:bpm_liberal_movement.political_movement_radicalism >= 0.2
					}
				}
			}
			add = 20
			multiply = ig:ig_christian_democrats.var:bpm_movement_liberal_pressure
			divide = 20
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_EVOLVING_CHRISTIAN_DEMOCRATS"

		add = var:christian_democrats_ideology_change

		multiply = 0.05
		#change_variable = { name = christian_democrats_ideology_change add = 1 }
	}
}

bpm_je_christian_democrat_welfare_rate = {
	value = 0

	add = {
		desc = "BPM_VALUE_FROM_INCLINATION_TOWARDS_MODERATION"
		add = -0.1
		multiply = var:christian_democrats_ideology_change
	}


	add = {
		desc = "BPM_VALUE_FROM_MARKET_WELFARE"
		if = { 
			limit = {
				bpm_country_laws_has_market_welfare = yes
			}
			if = {
				limit = {
					has_law = law_type:law_private_health_insurance
				}
				add = 0.1
			}
			if = {
				limit = {
					has_law = law_type:law_no_workers_rights
				}
				add = 0.1
			}
			if = {
				limit = {
					has_law = law_type:law_private_schools
				}
				add = 0.1
			}
			if = {
				limit = {
					has_law = law_type:law_poor_laws
				}
				add = 0.1
			}
			if = {
				limit = {
					has_law = law_type:law_child_labor_allowed
				}
				add = 0.1
			}
			else_if = {
				limit = {
					has_law = law_type:law_no_social_security
				}
				add = 0.2
			}
			if = {
				limit = {
					has_law = law_type:law_unregulated_work_time
				}
				add = 0.1
			}
			if = {
				limit = {
					has_law = law_type:law_illegal_labor_unions
				}
				add = 0.1
			}
			multiply = 0.5
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_IG_FACTIONS"
		if = {
			limit = { 
				OR = { 
					ig:ig_christian_democrats.var:bpm_movement_labor_pressure > 0.1
					OR = {
						var:bpm_labor_movement.political_movement_support >= 0.1
						var:bpm_labor_movement.political_movement_radicalism >= 0.2
					}
				}
			}
			add = var:bpm_labor_movement.political_movement_support
			multiply = 10
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_SOCIALISM_RESEARCHED"
		if = { 
			limit = {
				has_technology_researched = labor_movement
			}
			add = 0.1
		}
		if = { 
			limit = {
				has_technology_researched = socialism
			}
			add = 0.1
		}
		if = { 
			limit = {
				has_technology_researched = anarchism
			}
			add = 0.1
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_CORPORATISM_RESEARCHED"
		if = { 
			limit = {
				has_technology_researched = corporatism
			}
			add = -1.0
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_PATERNALISM"
		every_scope_character = {
			limit = {
				OR = {
					has_role = politician
					has_role = agitator
				}
				has_ideology = ideology:ideology_corporatist_leader
			}
			add = -0.2
		}
		every_interest_group = {
			limit = {
				bpm_ig_is_paternalistic = yes
			}
			add = -0.2
		}
	}
}

bpm_je_christdem_ideological_power = {
	value = 0

	add = {
		desc = "BPM_VALUE_BASE"
		value = 50
	}

	add = {
		desc = "BPM_VALUE_FROM_CHARACTER_POPULARITY"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_christian_democrats
				has_role = politician
			}
			add = popularity
		}
		divide = 2
	}

	add = {
		desc = "BPM_VALUE_FROM_IG_CLOUT"
		
		every_interest_group = {
			limit = {
				is_interest_group_type = ig_christian_democrats
			}
			add = ig_clout
			multiply = 100
			max = 10
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_EVENTS_AND_OTHER"
		
		if = {
			limit = {
				has_variable = wine_events_and_other_variable
			}

			add = {
				value = ROOT.ig:ig_christian_democrats.var:wine_events_and_other_variable
			}
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_TRAITS"
		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = direct
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = persistent
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = reckless
					}
				}
			}

			subtract = 15
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = meticulous
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = charismatic
					}
				}
			}

			add = 20
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = pious
					}
				}
			}

			add = 20
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = imposing
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = master_bureaucrat
					}
				}
			}

			add = 15
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = grifter
					}
				}
			}

			add = 5
		}
		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = ruthless
					}
				}
			}

			add = 5
		}
	}
}

bpm_je_clacon_ideological_power = {
	value = 0

	add = {
		desc = "BPM_VALUE_BASE"
		value = 50
	}

	add = {
		desc = "BPM_VALUE_FROM_CHARACTER_POPULARITY"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_conservatives
				has_role = politician
			}
			add = popularity
		}
		divide = 2
	}

	add = {
		desc = "BPM_VALUE_FROM_IG_CLOUT"
		
		every_interest_group = {
			limit = {
				is_interest_group_type = ig_conservatives
			}
			add = ig_clout
			multiply = 50
			max = 10
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_EVENTS_AND_OTHER"
		
		if = {
			limit = {
				has_variable = wine_events_and_other_variable
			}

			add = {
				value = ROOT.ig:ig_conservatives.var:wine_events_and_other_variable
			}
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_TRAITS"
		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = direct
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = persistent
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = reckless
					}
				}
			}

			subtract = 15
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = meticulous
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = charismatic
					}
				}
			}

			add = 20
		}

		if = {
			limit = {
				ig:ig_christian_democrats = {
					leader = {
						has_trait = pious
					}
				}
			}

			add = 20
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = imposing
					}
				}
			}

			add = 10
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = master_bureaucrat
					}
				}
			}

			add = 15
		}

		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = grifter
					}
				}
			}

			add = 5
		}
		if = {
			limit = {
				ig:ig_conservatives = {
					leader = {
						has_trait = ruthless
					}
				}
			}

			add = 5
		}
	}
}